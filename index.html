<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WeDrop Order</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4f8;
    margin: 0; padding: 20px;
    color: #222;
  }
  h1 {
    text-align: center;
    margin-bottom: 25px;
    color: #0077cc;
    font-weight: 700;
  }
  /* Container for categories */
  .categories {
    max-width: 640px;
    margin: 0 auto 30px auto;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 18px;
  }
  /* Each category tile */
  .category-tile {
    background: white;
    border-radius: 10px;
    box-shadow: 0 5px 12px rgba(0,0,0,0.12);
    padding: 22px 15px 15px 15px;
    cursor: pointer;
    position: relative;
    user-select: none;
    text-align: center;
    font-weight: 600;
    color: #004a7c;
    transition: box-shadow 0.3s ease, background-color 0.3s ease;
  }
  .category-tile:hover {
    box-shadow: 0 8px 18px rgba(0,0,0,0.2);
  }
  .category-tile.active {
    background-color: #0077cc;
    color: white;
  }
  /* Icon area */
  .category-icon {
    font-size: 48px;
    margin-bottom: 10px;
  }
  /* Items dropdown container under each category */
  .items-container {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: white;
    border-radius: 0 0 10px 10px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    z-index: 10;
    display: none;
    padding: 10px 10px 15px 10px;
  }
  .items-container.active {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    gap: 12px;
  }
  /* Each item tile */
  .item {
    flex: 1 1 45%;
    max-width: 45%;
    background: #e6f2fc;
    border-radius: 8px;
    padding: 12px;
    text-align: center;
    cursor: pointer;
    font-weight: 600;
    color: #004a7c;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    user-select: none;
    transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
  }
  .item:hover {
    background-color: #0077cc;
    color: white;
    box-shadow: 0 7px 15px rgba(0,119,204,0.7);
  }
  .item.selected {
    background-color: #004a7c;
    color: white;
    box-shadow: 0 7px 15px rgba(0,119,204,0.9);
  }

  /* Order summary container */
  .order-summary {
    max-width: 640px;
    margin: 0 auto;
    background: white;
    padding: 25px 30px;
    border-radius: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
  }
  .order-summary h2 {
    margin-top: 0;
    color: #0077cc;
    font-weight: 700;
    margin-bottom: 18px;
  }
  #orderList {
    list-style: none;
    padding-left: 0;
    max-height: 160px;
    overflow-y: auto;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 6px;
  }
  #orderList li {
    padding: 10px 15px;
    border-bottom: 1px solid #eee;
    font-weight: 600;
  }
  .total-container {
    font-size: 1.35rem;
    font-weight: 700;
    color: #005f99;
    text-align: right;
    margin-bottom: 25px;
  }
  /* Form styles */
  form label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #004a7c;
  }
  form input {
    width: 100%;
    padding: 11px 12px;
    font-size: 1rem;
    border: 2px solid #ddd;
    border-radius: 7px;
    margin-bottom: 18px;
    box-sizing: border-box;
    transition: border-color 0.3s ease;
  }
  form input:focus {
    outline: none;
    border-color: #0077cc;
  }
  /* Buttons */
  .buttons {
    text-align: right;
  }
  button {
    background: #0077cc;
    color: white;
    font-weight: 700;
    border: none;
    padding: 12px 28px;
    border-radius: 7px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease;
    margin-left: 12px;
  }
  button:hover {
    background: #005f99;
  }

  /* Responsive for smaller screens */
  @media (max-width: 480px) {
    .categories {
      grid-template-columns: 1fr !important;
      max-width: 100%;
      padding: 0 10px;
    }
    .category-tile {
      margin-bottom: 60px; /* give space for dropdown */
    }
    .items-container {
      position: static;
      width: 100% !important;
      box-shadow: none !important;
      border-radius: 0 0 10px 10px !important;
      padding: 15px 10px !important;
      display: none;
      flex-wrap: wrap;
      justify-content: space-between;
    }
    .items-container.active {
      display: flex;
    }
    .item {
      flex-basis: 48% !important;
      max-width: 48% !important;
      margin-bottom: 12px;
    }
  }
</style>
</head>
<body>

<h1>WeDrop Order</h1>

<div class="categories">
  <div class="category-tile" data-category="drinks">
    <div class="category-icon">ü•§</div>
    Drinks
    <div class="items-container" id="drinks">
      <div class="item" data-name="Pepsi" data-price="1.50">Pepsi ü•§ - $1.50</div>
      <div class="item" data-name="Diet Coke" data-price="1.60">Diet Coke ü•§ - $1.60</div>
      <div class="item" data-name="Sprite" data-price="1.40">Sprite ü•§ - $1.40</div>
      <div class="item" data-name="Orange Juice" data-price="2.00">Orange Juice üçä - $2.00</div>
    </div>
  </div>

  <div class="category-tile" data-category="chips">
    <div class="category-icon">üçü</div>
    Chips
    <div class="items-container" id="chips">
      <div class="item" data-name="Classic Chips" data-price="2.00">Classic Chips üçü - $2.00</div>
      <div class="item" data-name="Salted Chips" data-price="2.10">Salted Chips üßÇ - $2.10</div>
      <div class="item" data-name="BBQ Chips" data-price="2.50">BBQ Chips üî• - $2.50</div>
      <div class="item" data-name="Cheese Chips" data-price="2.70">Cheese Chips üßÄ - $2.70</div>
    </div>
  </div>

  <div class="category-tile" data-category="sweets">
    <div class="category-icon">üç¨</div>
    Sweets
    <div class="items-container" id="sweets">
      <div class="item" data-name="Chocolate Bar" data-price="1.20">Chocolate Bar üç´ - $1.20</div>
      <div class="item" data-name="Gummy Bears" data-price="1.00">Gummy Bears üêª - $1.00</div>
      <div class="item" data-name="Lollipop" data-price="0.50">Lollipop üç≠ - $0.50</div>
      <div class="item" data-name="Candy Cane" data-price="0.75">Candy Cane üç¨ - $0.75</div>
    </div>
  </div>

  <div class="category-tile" data-category="dairy">
    <div class="category-icon">ü•õ</div>
    Dairy
    <div class="items-container" id="dairy">
      <div class="item" data-name="Milk" data-price="2.50">Milk ü•õ - $2.50</div>
      <div class="item" data-name="Cheese" data-price="3.00">Cheese üßÄ - $3.00</div>
      <div class="item" data-name="Yogurt" data-price="1.80">Yogurt üç¶ - $1.80</div>
      <div class="item" data-name="Butter" data-price="2.20">Butter üßà - $2.20</div>
    </div>
  </div>
</div>

<div class="order-summary">
  <h2>Your Order</h2>
  <ul id="orderList"></ul>
  <div class="total-container">Total: $<span id="total">0.00</span></div>

  <form id="orderForm" onsubmit="return false;">
    <label for="name">Name</label>
    <input id="name" type="text" placeholder="Your name" required />
    <label for="phone">Phone</label>
    <input id="phone" type="tel" placeholder="Your phone number" required />
    <label for="address">Delivery Address</label>
    <input id="address" type="text" placeholder="Your delivery address" required />

    <div class="buttons">
      <button type="button" id="clearCart">Clear Cart</button>
      <button type="submit" id="submitOrder">Confirm Order</button>
    </div>
  </form>
</div>

<script>
  window.onload = function () {
    const categories = document.querySelectorAll(".category-tile");
    const selectedItems = new Map();

    // Handle category tile clicks: toggle only own items dropdown
    categories.forEach(cat => {
      const itemsContainer = cat.querySelector(".items-container");
      cat.addEventListener("click", () => {
        if (itemsContainer.classList.contains("active")) {
          // Close if already open
          itemsContainer.classList.remove("active");
          cat.classList.remove("active");
        } else {
          // Close others first
          categories.forEach(c => {
            c.classList.remove("active");
            c.querySelector(".items-container").classList.remove("active");
          });
          // Open clicked category
          itemsContainer.classList.add("active");
          cat.classList.add("active");
        }
      });
    });

    // Item selection logic
    const items = document.querySelectorAll(".item");
    items.forEach(item => {
      item.addEventListener("click", (e) => {
        e.stopPropagation(); // prevent triggering category toggle
        const name = item.dataset.name;
        const price = parseFloat(item.dataset.price);
        if (selectedItems.has(name)) {
          selectedItems.delete(name);
          item.classList.remove("selected");
        } else {
          selectedItems.set(name, price);
          item.classList.add("selected");
        }
        updateOrderList();
      });
    });

    const orderList = document.getElementById("orderList");
    const totalDisplay = document.getElementById("total");
    const clearCartBtn = document.getElementById("clearCart");
    const submitOrderBtn = document.getElementById("submitOrder");

    function updateOrderList() {
      orderList.innerHTML = "";
      let total = 0;
      selectedItems.forEach((price, name) => {
        const li = document.createElement("li");
        li.textContent = `${name} - $${price.toFixed(2)}`;
        orderList.appendChild(li);
        total += price;
      });
      totalDisplay.textContent = total.toFixed(2);
    }

    clearCartBtn.addEventListener("click", () => {
      selectedItems.clear();
      items.forEach(item => item.classList.remove("selected"));
      updateOrderList();
      document.getElementById("name").value = "";
      document.getElementById("phone").value = "";
      document.getElementById("address").value = "";
    });

    submitOrderBtn.addEventListener("click", () => {
      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const address = document.getElementById("address").value.trim();

      if (!name || !phone || !address) {
        alert("Please fill in all the fields.");
        return;
      }
      if (selectedItems.size === 0) {
        alert("Please select at least one item.");
        return;
      }

      const data = {
        name,
        phone,
        address,
        items: Array.from(selectedItems.keys()),
        total: parseFloat(totalDisplay.textContent)
      };

      fetch("https://script.google.com/macros/s/AKfycbxE2QqVzXYCWyYHJMlt1Y6SlqFMoQQtw6hubcXW9K9vvbN38-tVsmaLqJkvgFsmilSzTQ/exec", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify(data)
})
.then(response => response.json())
.then(res => {
  if (res.success) {
    alert("Order submitted successfully!");
    selectedItems.clear();
    items.forEach(item => item.classList.remove("selected"));
    updateOrderList();
    document.getElementById("name").value = "";
    document.getElementById("phone").value = "";
    document.getElementById("address").value = "";
  } else {
    alert("Something went wrong. Try again.");
  }
})
.catch(err => {
  alert("Network error. Please check your connection and try again.");
  console.error(err);
});

        selectedItems.clear();
        items.forEach(item => item.classList.remove("selected"));
        updateOrderList();
        document.getElementById("name").value = "";
        document.getElementById("phone").value = "";
        document.getElementById("address").value = "";
      })
      .catch(err => {
        alert("Network error. Please check your connection and try again.");
        console.error(err);
      });
    });
  };
</script>

</body>
</html>
